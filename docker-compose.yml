services:
  jaksa:
    container_name: mc-jaksa
    build:
      context: .
      dockerfile: Dockerfile
    image: mission-control:latest
    ports:
      - "4001:4000"
    environment:
      NODE_ENV: production
      DATABASE_PATH: /app/data/mission-control.db
      WORKSPACE_BASE_PATH: /app/workspace
      PROJECTS_PATH: /app/workspace/projects
      OPENCLAW_GATEWAY_URL: ws://host.docker.internal:18789
      OPENCLAW_GATEWAY_TOKEN: ${JAKSA_GATEWAY_TOKEN}
      MC_API_TOKEN: ${JAKSA_MC_API_TOKEN}
    volumes:
      - jaksa-data:/app/data
      - jaksa-workspace:/app/workspace
    restart: unless-stopped
    extra_hosts:
      - "host.docker.internal:host-gateway"

  aleksa:
    container_name: mc-aleksa
    build:
      context: .
      dockerfile: Dockerfile
    image: mission-control:latest
    ports:
      - "4002:4000"
    environment:
      NODE_ENV: production
      DATABASE_PATH: /app/data/mission-control.db
      WORKSPACE_BASE_PATH: /app/workspace
      PROJECTS_PATH: /app/workspace/projects
      OPENCLAW_GATEWAY_URL: ws://host.docker.internal:18839
      OPENCLAW_GATEWAY_TOKEN: ${ALEKSA_GATEWAY_TOKEN}
      MC_API_TOKEN: ${ALEKSA_MC_API_TOKEN}
    volumes:
      - aleksa-data:/app/data
      - aleksa-workspace:/app/workspace
    restart: unless-stopped
    extra_hosts:
      - "host.docker.internal:host-gateway"

volumes:
  jaksa-data:
  jaksa-workspace:
  aleksa-data:
  aleksa-workspace:
